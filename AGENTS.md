# 자판기 시스템 구현 예비 보고서

---

## 목차

1. [프로젝트 개요](#프로젝트-개요)  
2. [시스템 설계 순서도](#시스템-설계-순서도)  
3. [프로그램 구조 및 접근 방식](#프로그램-구조-및-접근-방식)  
4. [모듈 설계 계획](#모듈-설계-계획)  

---

## 프로젝트 개요

### 1. 프로젝트 목표
본 시스템은 Python으로 개발된 자판기 시스템으로 누구나 직관적으로 이용할 수 있는 GUI(Graphic User Interface) 환경을 제공하여 손쉽게 상품 선택과 결제를 수행할 수 있도록 한다.  
현금과 카드 결제 기능을 동일한 인터페이스 내에서 통합 지원함으로써 실제 자판기 환경과 유사한 서비스를 제공한다.  
상품별 재고 현황을 관리하고, 결제 오류나 재고 부족 상황 발생 시에도 시스템이 안정적으로 복구될 수 있도록 신뢰성 있는 예외 처리 체계를 마련한다.  
기능별·계층별 모듈화 설계를 통해 코드의 가독성과 객체지향 프로그래밍의 장점을 활용하고, 향후 추가 기능의 확장성을 지원하도록 한다.  

### 2. 자판기 동작 방식

#### 가. 사용자 흐름
- **현금/카드 투입**  
- **음료 선택**  
- **거스름돈 반환**  

#### 나. 관리자 흐름
- **관리자 인증**  
- **메뉴 선택**  
- **재고 관리**  
  - 재고 충전  
  - 메뉴 구성 변경  
- **현금 관리**  
  - 현금 수거  
  - 현금 충전  

### 3. 제약 사항
- 현금은 **1,000원**, **500원**, **100원**, **50원** 화폐만 사용 가능하며, 거스름돈 역시 해당 단위로만 계산되어야 한다.  

---

## 시스템 설계 순서도
[Flow Chart 이미지 삽입](/src/refund_flow_chart.png)

---

## 프로그램 구조 및 접근 방식

### 1. 프로그램 설계 구조
본 시스템은 객체지향 프로그램 구조로 설계된다.  
- **Machine 클래스**: 자판기 GUI 구현 담당  
- **Drink 클래스**: 음료수 관리 담당  
- **Controller 클래스**: 비즈니스 로직(현금 시재·재고 관리 등) 담당  
- **Card 클래스**: 카드 결제 모듈 담당  

총 4개의 클래스로 프로그램을 구성하여 역할별로 분리된 설계를 적용한다.  

### 2. 주요 기능

| 액터     | 기능           | 설명                                                                            |
|---------|--------------|-------------------------------------------------------------------------------|
| 사용자   | 현금 투입      | 현금을 자판기에 투입한다.                                                               |
|          | 카드 투입      | 신용카드를 자판기에 투입하여 카드 결제를 요청한다.                                            |
|          | 음료 선택      | 결제 준비가 완료되면 음료를 선택하여 음료를 뽑는다.                                              |
| 관리자   | 현금 시재 관리  | 자판기에 누적된 현금 시재를 추가하거나 회수한다.                                               |
|          | 재고 관리      | 자판기에 등록된 음료의 재고를 추가하거나 종류를 교체한다.                                          |
| 자판기   | 거스름돈 반환   | 사용자가 투입한 현금 중에서 음료 값을 제외한 거스름돈을 반환한다.                                     |
|          | 카드 승인 요청  | 사용자가 투입한 신용카드 정보를 카드사에 전송하여 결제 승인을 요청한다.                                |
|          | 음료 배출      | 사용자가 선택한 음료를 배출한다.                                                           |
|          | 모드 전환      | 사용자 모드와 관리자 모드를 전환하여 기능 접근을 제어한다.                                           |

---

## 모듈 설계 계획

| 클래스명       | 요소명                  | 설명                                                                                                                                                                          |
|---------------|-----------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **Machine**   | `controller`          | 자판기를 관리할 컨트롤러 멤버 변수                                                                                                                                                    |
|               | `build_frame()`       | 자판기 GUI 레이아웃을 작성할 함수. 생성 단계에서 한 번만 호출된다.                                                                                                                    |
|               | `admin_menu()`        | 관리자 모드로 진입하는 함수                                                                                                                                                |
| **Drink**     | `name`                | 음료명을 저장하는 멤버 변수                                                                                                                                                         |
|               | `price`               | 음료 가격을 저장하는 멤버 변수                                                                                                                                                        |
|               | `count`               | 음료 재고를 저장하는 멤버 변수                                                                                                                                                        |
| **Card**      | `status`              | 결제 상태를 저장하는 멤버 변수                                                                                                                                                         |
|               | `accept()`            | 카드 결제 승인을 처리하는 함수                                                                                                                                                         |
| **Controller**| `cashes`              | 현금 시재를 관리할 딕셔너리형 멤버 변수 (`Dict[int, int]`, 형태: `{화폐단위: 개수}`)                                                                                                 |
|               | `drinks`              | 음료 재고를 관리할 리스트형 멤버 변수 (`List[Drink]`)                                                                                                                           |
|               | `card`                | 카드 결제 모듈을 관리할 멤버 변수                                                                                                                                                       |
|               | `input_cash(amount)`  | Machine으로 투입된 현금을 딕셔너리형 매개변수로 받아 `cashes`에 누적하는 함수                                                                                                            |
|               | `refund_cash()`       | 거스름돈을 반환하는 함수                                                                                                                                                               |
|               |                       | **알고리즘**:                                                                                                                                                                   |
|               |                       |  1. `total_change`(거스름돈 총액)을 정의한다. <br> 2. `cashes`의 key인 `currency`(화폐 단위)를 큰 단위부터 반복 탐색한다.                                                   |
|               |                       |  3. `cashes[currency]`가 1개 이상이고, `total_change`가 `currency` 이상이면: <br>     - `cashes[currency]`를 1개 차감 <br>     - `refunds[currency]`를 1개 증가 <br>     - `total_change -= currency` |
|               |                       |  4. 2~3 과정을 `total_change`가 0이 될 때까지 반복한다. <br> 5. 최종 `refunds` 딕셔너리를 반환한다.                                                                            |
|               | `add_drinks(drink)`   | 관리자가 음료 재고를 추가하는 함수                                                                                                                                                        |
|               | `dispense(drink)`     | 사용자가 선택한 음료를 제공하는 함수                                                                                                                                                      |

---
